<!DOCTYPE html>
<html lang="en" class="hydrated">

<head>
  <meta charset="utf-8" />
  <title>Ionic App</title>

  <base href="/" />

  <meta name="color-scheme" content="light dark" />
  <meta name="viewport"
    content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="msapplication-tap-highlight" content="no" />

  <link rel="icon" type="image/png" href="assets/icon/favicon.png" />

  <!-- add to homescreen for ios -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#1976d2">
</head>

<body id="__body">
  <app-root></app-root>

  <style>
    ul {
      list-style-type: none;
      margin: 0;
      padding: 0;
    }

    li {
      display: inline;
    }

    button {
      background-color: #4CAF50;
      /* Green */
      border: none;
      color: white;
      padding: 15px 32px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
    }

    .main_stuff {
      overflow: scroll !important;
    }
  </style>

  <main id="__main_static" style="visibility: hidden;" class="main_stuff">
    <ul>
      <li><a href="#home">Home</a></li>
      <li><a href="#news">News</a></li>
      <li><a href="#contact">Contact</a></li>
      <li><a href="#about">About</a></li>
    </ul>
    <button type="button" onclick="bootApp();">Let's go to app</button>
    <p>
      The above links should/could show other static content. Obviously, there must be exceptions in the rewrite rules
      of the server defined. And these routes should not interfere with the routes of the app.
    </p>
    <p>
      Alternatively, you can use base-href to define a different location for the routes..
    </p>
    <p> All sorts of content can come here, explaining the great app. And that you can or even should install it to go
      on
      with it. And that the button below creates all the magic you need.
    </p>
    <p>
      To test the PWA version of this app - you can either already install it (if you have chrome, you are likely
      already seeing install icon in the URL).
    </p>
    <p>
      Or if you just want to boot the app, click the button below.
    </p>
    <p>
      Of course, in real life, we wouldn't say "boot", but say - "acces app" or "signup" or maybe even "install" -
      leading to beforeinstallprompt actions...
    </p>
    <p>
      Please note - there is no automatic service worker update routing in the code. So if you want to check for a new
      version of this app - please unregister the service worker in devtools.
    </p>
    <button type="button" onclick="bootApp();">Let's go to app</button>

    <p>
      One issue (probably more) - no scrollbar for vertical scrolling??
    </p>
  </main>

  <script>

    // we need to override somes styles on body - NOT WORKING
    const element = document.getElementById('__body');
    console.log('asdsadasdasdsasdasdasds', element)

    console.log('asdasdasds22', element.style.position, element.style.overflow)

    element.style.backgroundColor = 'red'; // this is working
    element.style.position = 'initial';
    element.style.overflow = 'visible';
    // element.style.removeProperty('position');
    // element.style.removeProperty('overflow');

    setTimeout(() => {
      element.style.removeProperty('position');
      element.style.removeProperty('overflow');

    }, 4000)

    console.log('asdasdasds3e3', element.style.position, element.style.overflow)

    // Are we not SPA - then we show the static content
    const isPWA = (win) => !!(win.matchMedia?.('(display-mode: standalone)').matches || (win.navigator).standalone);
    // the maincontent is hidden by default (SEO ISSUE?) because in PWA mode it shows at startup
    const mainContent = document.getElementById('__main_static');
    if (!isPWA(window)) mainContent.style.visibility = 'visible';

    // and the magical hook bringing us the SPA
    const bootApp = () => {
      mainContent.style.visibility = 'hidden';
      window['bootAngularSPA']();
    }

    // let's get the service worker going pre-angular - but only when not in dev
    if ('serviceWorker' in navigator && !window.location.href.includes('localhost')) {
      navigator.serviceWorker.register('/ngsw-worker.js')
    }

  </script>


  <noscript>Please enable JavaScript to continue using this application.</noscript>

</body>

</html>
